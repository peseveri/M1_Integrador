{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2025-07-23T17:02:46.777334Z", "invocation_id": "72a5cf22-63de-481c-8d94-3f886d92db92", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:44.663591Z", "completed_at": "2025-07-23T17:02:44.668591Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:44.670591Z", "completed_at": "2025-07-23T17:02:44.815833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15624523162841797, "adapter_response": {"_message": "SUCCESS 2557", "code": "SUCCESS", "rows_affected": 2557}, "message": "SUCCESS 2557", "failures": null, "unique_id": "model.ecommerceDBT.dim_tiempo", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/gold/dim_tiempo.sql (ACTUALIZADO - Sin dbt_utils.date_spine - Para MySQL < 8.0)\n\n\nWITH nums AS (\n    -- Genera una serie de n\u00fameros que cubra el rango de d\u00edas\n    SELECT 0 AS n UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9\n),\nhundreds AS (\n    SELECT (t1.n + t2.n * 10 + t3.n * 100 + t4.n * 1000) AS num\n    FROM nums AS t1\n    CROSS JOIN nums AS t2\n    CROSS JOIN nums AS t3\n    CROSS JOIN nums AS t4 -- Puedes a\u00f1adir m\u00e1s joins si necesitas m\u00e1s d\u00edas (ej. t5.n * 10000 para 100,000 d\u00edas)\n),\ndate_series AS (\n    SELECT DATE_ADD('2020-01-01', INTERVAL num DAY) AS fecha_generada_raw\n    FROM hundreds\n    WHERE DATE_ADD('2020-01-01', INTERVAL num DAY) <= '2026-12-31'\n)\nSELECT\n    CAST(DATE_FORMAT(fecha_generada_raw, '%Y%m%d') AS UNSIGNED) AS tiempo_id,\n    fecha_generada_raw AS fecha,\n    YEAR(fecha_generada_raw) AS anio,\n    MONTH(fecha_generada_raw) AS mes,\n    MONTHNAME(fecha_generada_raw) AS nombre_mes,\n    CASE DAYOFWEEK(fecha_generada_raw)\n        WHEN 1 THEN 7 -- Domingo\n        WHEN 2 THEN 1 -- Lunes\n        WHEN 3 THEN 2 -- Martes\n        WHEN 4 THEN 3 -- Mi\u00e9rcoles\n        WHEN 5 THEN 4 -- Jueves\n        WHEN 6 THEN 5 -- Viernes\n        WHEN 7 THEN 6 -- S\u00e1bado\n    END AS dia_semana_num,\n    DAYNAME(fecha_generada_raw) AS nombre_dia_semana\nFROM date_series\nORDER BY fecha_generada_raw", "relation_name": "`ecommercedb`.`dim_tiempo`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:44.821833Z", "completed_at": "2025-07-23T17:02:44.823833Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:44.824834Z", "completed_at": "2025-07-23T17:02:44.878834Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.059000253677368164, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_categorias", "compiled": true, "compiled_code": "SELECT\r\n    CategoriaID AS category_id,\r\n    Nombre AS nombre,\r\n    Descripcion AS descripcion\r\nFROM ecommercedb.categorias", "relation_name": "`ecommercedb`.`stg_categorias`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:44.884833Z", "completed_at": "2025-07-23T17:02:44.885833Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:44.886834Z", "completed_at": "2025-07-23T17:02:44.933836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05200052261352539, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_detalle_ordenes", "compiled": true, "compiled_code": "SELECT\r\n    DetalleID AS id_linea_venta,\r\n    OrdenID AS orden_id,\r\n    ProductoID AS product_id,\r\n    Cantidad AS cantidad,\r\n    PrecioUnitario AS precio_unitario\r\nFROM ecommercedb.detalleordenes", "relation_name": "`ecommercedb`.`stg_detalle_ordenes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:44.939836Z", "completed_at": "2025-07-23T17:02:44.941836Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:44.942836Z", "completed_at": "2025-07-23T17:02:44.986833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05000424385070801, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_direcciones_envio", "compiled": true, "compiled_code": "SELECT\r\n    DireccionID AS direccion_id,\r\n    UsuarioID AS user_id,\r\n    Calle AS calle,\r\n    Ciudad AS ciudad,\r\n    Departamento AS departamento,\r\n    Provincia AS provincia,\r\n    Distrito AS distrito,\r\n    Estado AS estado,\r\n    CodigoPostal AS codigo_postal,\r\n    Pais AS pais\r\nFROM ecommercedb.direccionesenvio", "relation_name": "`ecommercedb`.`stg_direcciones_envio`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:44.992832Z", "completed_at": "2025-07-23T17:02:44.994832Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:44.995835Z", "completed_at": "2025-07-23T17:02:45.041833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05100107192993164, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_historial_pagos", "compiled": true, "compiled_code": "SELECT\r\n    PagoID AS id_pago,\r\n    OrdenID AS order_id,\r\n    MetodoPagoID AS id_metodo_pago,\r\n    Monto AS monto_pagado,\r\n    FechaPago AS fecha_pago,\r\n    EstadoPago AS estado_pago\r\nFROM ecommercedb.historialpagos", "relation_name": "`ecommercedb`.`stg_historial_pagos`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.047836Z", "completed_at": "2025-07-23T17:02:45.050836Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.051836Z", "completed_at": "2025-07-23T17:02:45.096832Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.051998138427734375, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_metodos_pago", "compiled": true, "compiled_code": "SELECT\r\n    MetodoPagoID AS id_metodo_pago,\r\n    Nombre AS nombre_metodo,\r\n    Descripcion AS descripcion\r\nFROM ecommercedb.metodospago", "relation_name": "`ecommercedb`.`stg_metodos_pago`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.102833Z", "completed_at": "2025-07-23T17:02:45.103833Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.104838Z", "completed_at": "2025-07-23T17:02:45.149832Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05000162124633789, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_ordenes", "compiled": true, "compiled_code": "SELECT\r\n    OrdenID AS orden_id,\r\n    UsuarioID AS user_id,\r\n    FechaOrden AS fecha_orden\r\nFROM ecommercedb.ordenes", "relation_name": "`ecommercedb`.`stg_ordenes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.156832Z", "completed_at": "2025-07-23T17:02:45.157832Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.158833Z", "completed_at": "2025-07-23T17:02:45.204833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05099987983703613, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_productos", "compiled": true, "compiled_code": "SELECT\r\n    ProductoID AS product_id,\r\n    Nombre AS nombre,\r\n    Descripcion AS descripcion,\r\n    Precio AS precio_actual,\r\n    Stock AS stock,\r\n    CategoriaID AS category_id\r\nFROM ecommercedb.productos", "relation_name": "`ecommercedb`.`stg_productos`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.210832Z", "completed_at": "2025-07-23T17:02:45.212836Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.213836Z", "completed_at": "2025-07-23T17:02:45.259834Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05299878120422363, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_rese\u00f1as", "compiled": true, "compiled_code": "SELECT\r\n    Rese\u00f1aID AS id_rese\u00f1a,\r\n    UsuarioID AS user_id, \r\n    ProductoID AS product_id,\r\n    Calificacion AS rating,\r\n    Comentario AS comentario,\r\n    Fecha AS fecha_rese\u00f1a\r\nFROM ecommercedb.rese\u00f1asproductos", "relation_name": "`ecommercedb`.`stg_rese\u00f1as`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.265832Z", "completed_at": "2025-07-23T17:02:45.267834Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.268834Z", "completed_at": "2025-07-23T17:02:45.313833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05100297927856445, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.stg_usuarios", "compiled": true, "compiled_code": "SELECT\r\n    UsuarioID AS user_id,\r\n    Nombre AS nombre,\r\n    Apellido AS apellido,\r\n    FechaRegistro AS fecha_registro\r\nFROM ecommercedb.usuarios", "relation_name": "`ecommercedb`.`stg_usuarios`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.319833Z", "completed_at": "2025-07-23T17:02:45.322831Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.323835Z", "completed_at": "2025-07-23T17:02:45.391832Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07399964332580566, "adapter_response": {"_message": "SUCCESS 12", "code": "SUCCESS", "rows_affected": 12}, "message": "SUCCESS 12", "failures": null, "unique_id": "model.ecommerceDBT.dim_categoria", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/gold/dim_categoria.sql (ACTUALIZADO)\n\n\nSELECT\n    category_id AS categoria_id, -- Usar category_id de stg_categorias\n    nombre,\n    descripcion\n    -- categorizacion -- Removido\nFROM `ecommercedb`.`stg_categorias`", "relation_name": "`ecommercedb`.`dim_categoria`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.397833Z", "completed_at": "2025-07-23T17:02:45.399832Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.400833Z", "completed_at": "2025-07-23T17:02:45.446833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05199623107910156, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.int_base_pagos", "compiled": true, "compiled_code": "SELECT id_pago, order_id, id_metodo_pago, fecha_pago, monto_pagado, estado_pago FROM `ecommercedb`.`stg_historial_pagos`", "relation_name": "`ecommercedb`.`int_base_pagos`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.452836Z", "completed_at": "2025-07-23T17:02:45.455836Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.456836Z", "completed_at": "2025-07-23T17:02:45.523271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07243776321411133, "adapter_response": {"_message": "SUCCESS 7", "code": "SUCCESS", "rows_affected": 7}, "message": "SUCCESS 7", "failures": null, "unique_id": "model.ecommerceDBT.dim_metodo_pago", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/gold/dim_metodo_pago.sql (VERIFICAR/ACTUALIZAR)\n\n\nSELECT\n    id_metodo_pago AS metodo_pago_id, -- \u00a1Aseg\u00farate de que id_metodo_pago se aliasa a metodo_pago_id!\n    nombre_metodo,\n    descripcion\nFROM `ecommercedb`.`stg_metodos_pago`", "relation_name": "`ecommercedb`.`dim_metodo_pago`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.529274Z", "completed_at": "2025-07-23T17:02:45.532273Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.533273Z", "completed_at": "2025-07-23T17:02:45.578127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05085635185241699, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.int_base_ventas", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/intermediate/int_base_ventas.sql (VERIFICAR/ACTUALIZAR)\nSELECT\n    od.orden_id, -- \u00a1Aseg\u00farate de que esta columna est\u00e9 aqu\u00ed!\n    od.product_id,\n    od.cantidad,\n    od.precio_unitario,\n    o.fecha_orden AS fecha_venta, -- Asumiendo que unes con stg_ordenes para la fecha\n    o.user_id      -- Asumiendo que unes con stg_ordenes para el user_id\nFROM `ecommercedb`.`stg_detalle_ordenes` od -- O tu modelo de staging de detalles de \u00f3rdenes\nLEFT JOIN `ecommercedb`.`stg_ordenes` o ON od.orden_id = o.orden_id -- Si tienes una tabla de encabezado de \u00f3rdenes", "relation_name": "`ecommercedb`.`int_base_ventas`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.584127Z", "completed_at": "2025-07-23T17:02:45.591127Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.592126Z", "completed_at": "2025-07-23T17:02:45.644129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06399869918823242, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.int_productos_scd", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/intermediate/int_productos_scd.sql (ACTUALIZADO - Clave Subrogada Manual)\n\n\nWITH\n    productos_fuente AS (\n        SELECT\n            product_id,\n            nombre,\n            descripcion,\n            category_id AS id_categoria,\n            precio_actual,\n            stock,\n            CURRENT_DATE() AS fecha_inicio_validez_scd_raw\n        FROM `ecommercedb`.`stg_productos`\n    ),\n    productos_cambios AS (\n        SELECT\n            product_id,\n            nombre,\n            descripcion,\n            id_categoria,\n            precio_actual,\n            stock,\n            fecha_inicio_validez_scd_raw,\n            -- IMPLEMENTACI\u00d3N MANUAL DE CLAVE SUBROGADA PARA MYTQL\n            MD5(\n                CONCAT_WS(\n                    '__', -- Separador robusto para evitar colisiones\n                    COALESCE(CAST(product_id AS CHAR), '_NULL_'),\n                    COALESCE(CAST(id_categoria AS CHAR), '_NULL_'),\n                    COALESCE(CAST(precio_actual AS CHAR), '_NULL_'),\n                    COALESCE(CAST(stock AS CHAR), '_NULL_'),\n                    COALESCE(CAST(fecha_inicio_validez_scd_raw AS CHAR), '_NULL_')\n                )\n            ) AS producto_sk\n            -- FIN DE IMPLEMENTACI\u00d3N MANUAL\n        FROM productos_fuente\n    )\nSELECT\n    pc.producto_sk,\n    pc.product_id,\n    pc.nombre,\n    pc.descripcion,\n    pc.id_categoria,\n    pc.precio_actual,\n    pc.stock,\n    pc.fecha_inicio_validez_scd_raw AS fecha_inicio_validez_scd,\n    CAST('9999-12-31' AS DATE) AS fecha_fin_validez_scd,\n    TRUE AS es_actual\nFROM productos_cambios pc\n\n\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM `ecommercedb`.`int_productos_scd` AS old_data\n    WHERE old_data.product_id = pc.product_id\n      AND old_data.es_actual = TRUE\n      AND old_data.id_categoria = pc.id_categoria\n      AND old_data.precio_actual = pc.precio_actual\n      AND old_data.stock = pc.stock\n)\n", "relation_name": "`ecommercedb`.`int_productos_scd`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.650126Z", "completed_at": "2025-07-23T17:02:45.653126Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.654127Z", "completed_at": "2025-07-23T17:02:45.699126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.052001953125, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.int_base_rese\u00f1as", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/intermediate/int_base_rese\u00f1as.sql (CORRECCI\u00d3N)\nSELECT\n    id_rese\u00f1a,\n    user_id,\n    product_id,\n    rating,\n    comentario, -- Si necesitas el comentario\n    fecha_rese\u00f1a -- Aseg\u00farate de que este nombre coincida con el alias en stg_rese\u00f1as\nFROM `ecommercedb`.`stg_rese\u00f1as`", "relation_name": "`ecommercedb`.`int_base_rese\u00f1as`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.705129Z", "completed_at": "2025-07-23T17:02:45.709129Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.710130Z", "completed_at": "2025-07-23T17:02:45.752129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04900360107421875, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.int_usuarios_scd", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/intermediate/int_usuarios_scd.sql (VERSI\u00d3N FINAL DE CORRECCI\u00d3N)\n\n\nWITH\n    usuarios_fuente AS (\n        SELECT\n            user_id,\n            nombre,\n            apellido,\n            fecha_registro\n        FROM `ecommercedb`.`stg_usuarios`\n    ),\n    direcciones_con_rn AS (\n        SELECT\n            direccion_id,\n            user_id,\n            CONCAT_WS(', ', calle, ciudad, departamento, provincia, distrito, estado, codigo_postal, pais) AS direccion_completa,\n            ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY direccion_id DESC) AS rn\n        FROM `ecommercedb`.`stg_direcciones_envio`\n    ),\n    direcciones_usuario AS (\n        SELECT\n            user_id,\n            direccion_completa\n        FROM direcciones_con_rn\n        WHERE rn = 1\n    ),\n    usuarios_con_direccion AS (\n        SELECT\n            u.user_id,\n            u.nombre,\n            u.apellido,\n            COALESCE(du.direccion_completa, 'Direccion Desconocida') AS direccion,\n            u.fecha_registro\n        FROM usuarios_fuente u\n        LEFT JOIN direcciones_usuario du ON u.user_id = du.user_id\n    ),\n    usuarios_cambios AS (\n        SELECT\n            user_id,\n            nombre,\n            apellido,\n            direccion,\n            fecha_registro,\n            fecha_registro AS fecha_inicio_validez_scd, -- Renombrado aqu\u00ed, se usa en la SELECT final\n            CAST('9999-12-31' AS DATE) AS fecha_fin_validez_scd, -- Definida aqu\u00ed, se usa en la SELECT final\n            TRUE AS es_actual_scd, -- Definida aqu\u00ed, se usa en la SELECT final\n            MD5(\n                CONCAT_WS(\n                    '__',\n                    COALESCE(CAST(user_id AS CHAR), '_NULL_'),\n                    COALESCE(CAST(direccion AS CHAR), '_NULL_'),\n                    COALESCE(CAST(fecha_registro AS CHAR), '_NULL_')\n                )\n            ) AS usuario_sk\n        FROM usuarios_con_direccion\n    )\nSELECT\n    -- Seleccionar expl\u00edcitamente cada columna con su nombre final aqu\u00ed\n    -- para asegurarse de que dbt las \"vea\" correctamente.\n    usuario_sk,\n    user_id,\n    nombre,\n    apellido,\n    direccion,\n    fecha_registro,\n    fecha_inicio_validez_scd,\n    fecha_fin_validez_scd,\n    es_actual_scd\nFROM usuarios_cambios -- \u00a1Usar el alias de la CTE final!\n\n\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM `ecommercedb`.`int_usuarios_scd` AS old_data\n    WHERE old_data.user_id = usuarios_cambios.user_id -- Aseg\u00farate de referenciar el alias de la CTE\n      AND old_data.es_actual_scd = 1\n      AND old_data.direccion = usuarios_cambios.direccion\n)\n", "relation_name": "`ecommercedb`.`int_usuarios_scd`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.758127Z", "completed_at": "2025-07-23T17:02:45.761126Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.762127Z", "completed_at": "2025-07-23T17:02:45.944404Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1882779598236084, "adapter_response": {"_message": "SUCCESS 10000", "code": "SUCCESS", "rows_affected": 10000}, "message": "SUCCESS 10000", "failures": null, "unique_id": "model.ecommerceDBT.fact_pagos", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/gold/fact_pagos.sql (VERIFICAR)\n\n\nSELECT\n    bp.id_pago AS pago_id,\n    bp.order_id,\n    mp.metodo_pago_id, -- Esta columna ahora deber\u00eda existir en 'mp' (dim_metodo_pago)\n    t.tiempo_id,\n    bp.monto_pagado,\n    bp.estado_pago\nFROM `ecommercedb`.`int_base_pagos` bp\nLEFT JOIN `ecommercedb`.`dim_metodo_pago` mp ON bp.id_metodo_pago = mp.metodo_pago_id\nLEFT JOIN `ecommercedb`.`dim_tiempo` t ON DATE_FORMAT(bp.fecha_pago, '%Y%m%d') = t.tiempo_id", "relation_name": "`ecommercedb`.`fact_pagos`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:45.949407Z", "completed_at": "2025-07-23T17:02:45.952407Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:45.954408Z", "completed_at": "2025-07-23T17:02:46.023628Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07622337341308594, "adapter_response": {"_message": "SUCCESS 36", "code": "SUCCESS", "rows_affected": 36}, "message": "SUCCESS 36", "failures": null, "unique_id": "model.ecommerceDBT.dim_producto", "compiled": true, "compiled_code": "-- Archivo: Avane3/models/gold/dim_producto.sql (ACTUALIZADO)\n\n\nSELECT\n    p.producto_sk,\n    p.product_id,\n    p.nombre,\n    p.descripcion,\n    c.category_id AS categoria_id, -- Usar category_id de stg_categorias\n    c.nombre AS nombre_categoria,\n    c.descripcion AS descripcion_categoria,\n    -- c.categorizacion, -- Removido, ya que no est\u00e1 en la tabla de origen Categorias\n    p.precio_actual,\n    p.stock, -- A\u00f1adido\n    p.fecha_inicio_validez_scd,\n    p.fecha_fin_validez_scd,\n    p.es_actual\nFROM `ecommercedb`.`int_productos_scd` p\nJOIN `ecommercedb`.`stg_categorias` c ON p.id_categoria = c.category_id", "relation_name": "`ecommercedb`.`dim_producto`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:46.028625Z", "completed_at": "2025-07-23T17:02:46.031628Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:46.032629Z", "completed_at": "2025-07-23T17:02:46.128332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10170531272888184, "adapter_response": {"_message": "SUCCESS 1000", "code": "SUCCESS", "rows_affected": 1000}, "message": "SUCCESS 1000", "failures": null, "unique_id": "model.ecommerceDBT.dim_usuario", "compiled": true, "compiled_code": "\n\nSELECT\n    usuario_sk,\n    user_id,\n    nombre,\n    apellido,\n    direccion,\n    fecha_registro,\n    fecha_fin_validez_scd,\n    es_actual_scd\nFROM `ecommercedb`.`int_usuarios_scd`", "relation_name": "`ecommercedb`.`dim_usuario`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:46.134330Z", "completed_at": "2025-07-23T17:02:46.137330Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:46.138332Z", "completed_at": "2025-07-23T17:02:46.218331Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0859994888305664, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.fact_rese\u00f1as", "compiled": true, "compiled_code": "\nSELECT br.id_rese\u00f1a, prod.producto_sk, dt.tiempo_id, br.rating FROM `ecommercedb`.`int_base_rese\u00f1as` br JOIN `ecommercedb`.`dim_producto` prod ON br.product_id = prod.product_id AND br.fecha_rese\u00f1a BETWEEN prod.fecha_inicio_validez_scd AND prod.fecha_fin_validez_scd JOIN `ecommercedb`.`dim_tiempo` dt ON br.fecha_rese\u00f1a = dt.fecha", "relation_name": "`ecommercedb`.`fact_rese\u00f1as`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-23T17:02:46.224330Z", "completed_at": "2025-07-23T17:02:46.227330Z"}, {"name": "execute", "started_at": "2025-07-23T17:02:46.228332Z", "completed_at": "2025-07-23T17:02:46.760332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5390028953552246, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.ecommerceDBT.fact_ventas", "compiled": true, "compiled_code": "\nSELECT  bv.orden_id, prod.producto_sk, us.usuario_sk, dt.tiempo_id, bv.precio_unitario, bv.cantidad, (bv.precio_unitario * bv.cantidad) AS total_linea FROM `ecommercedb`.`int_base_ventas` bv JOIN `ecommercedb`.`dim_producto` prod ON bv.product_id = prod.product_id AND bv.fecha_venta BETWEEN prod.fecha_inicio_validez_scd AND prod.fecha_fin_validez_scd JOIN `ecommercedb`.`dim_usuario` us ON bv.user_id = us.user_id AND bv.fecha_venta JOIN `ecommercedb`.`dim_tiempo` dt ON bv.fecha_venta = dt.fecha", "relation_name": "`ecommercedb`.`fact_ventas`"}], "elapsed_time": 2.1727442741394043, "args": {"log_path": "P:\\Accenture_Henry\\M1_Integrador\\Avance3\\ecommerceDBT\\logs", "quiet": false, "favor_state": false, "partial_parse": true, "enable_legacy_logger": false, "exclude": [], "log_level_file": "debug", "invocation_command": "dbt run", "printer_width": 80, "populate_cache": true, "vars": {}, "cache_selected_only": false, "profiles_dir": "C:\\Users\\Pedro\\.dbt", "macro_debugging": false, "introspect": true, "indirect_selection": "eager", "static_parser": true, "use_colors": true, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "select": [], "strict_mode": false, "log_level": "info", "print": true, "log_file_max_bytes": 10485760, "log_format_file": "debug", "defer": false, "which": "run", "project_dir": "P:\\Accenture_Henry\\M1_Integrador\\Avance3\\ecommerceDBT", "use_colors_file": true, "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": false, "log_format": "default", "show_resource_report": false, "partial_parse_file_diff": true, "write_json": true}}